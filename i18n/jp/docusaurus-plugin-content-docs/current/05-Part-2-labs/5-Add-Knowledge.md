# 知識の追加

:::tip Retrieval Augmented Generation
Retrieval-Augmented Generation（RAG）は、データベースから関連情報を取得し、それを使用してより情報に基づいた文脈的に正確なテキスト応答を生成するのを助けるAI技術です。
:::  
   
このラボでは、会話に新しい知識を追加します。これは、プロダクションシナリオで自分のデータを追加するプロセスがどのように機能するかを示すものです。データを手動で追加しますが、さまざまな技術やツールを使用してデータを取得し、アシスタントとの会話に追加することができます。  
   
## 現在の情報を追加する:  
   
私たちのアウトドアハイキング会社のためのアシスタントを作成し、ユーザーが製品について質問したり、会社が販売している製品に関する推奨を受けることができるようにするとします。  
   
泥だらけの山への旅行のために、顧客がハイキングシューズを探しています。  
   
```text title="ユーザープロンプトに入力:"  
泥だらけの旅行に適したハイキングシューズをおすすめしてくれませんか？  
```  
   
モデルが多くの素晴らしい提案を返しますが、そのどれもが私たちの会社が販売しているものではないことがわかります。  
   
まず、モデルに実行時に正しい情報を提供し、微調整なしでその問題を修正しましょう。  
   
まず、アシスタントに特定のタスクを与えることから始めます。  
   
```text title="システムメッセージに入力:"  
## タスク  
あなたはTrailwalkerハイキングシューズ店のAIアシスタントです。あなたはユーザーが私たちのシューズ製品についての質問に答えるのを助けます。  
あなたは製品情報を含む検索結果として取得されたドキュメントを与えられます。  
あなたの回答はできるだけ正確であるべきです。  
あなたの回答は製品情報を含む取得されたドキュメントからのみ来るべきです。  
取得されたドキュメントにユーザーのメッセージに完全に答えるための十分な情報が含まれていない場合、質問に答えず、十分な情報がないことをユーザーに通知します。  
   
## 取得されたドキュメント  
情報が見つかりませんでした。  
```  
   
```text title="ユーザープロンプトに入力:"  
泥だらけの旅行に適したハイキングシューズをおすすめしてくれませんか？  
```  
   
アシスタントが質問に答えるための十分な情報がないと応答することに注目してください。  
   
次に、プロンプトに製品情報を追加しましょう。ここで、データベースで検索クエリを実行し、以下の製品を取得したと想像してください。  
   
取得されたドキュメントでシステムメッセージを更新します:  
   
```text title="システムメッセージに入力:"  
あなたはTrailwalkerハイキングシューズ店のAIアシスタントです。あなたはユーザーが私たちのシューズ製品についての質問に答えるのを助けます。  
あなたは製品情報を含む検索結果として取得されたドキュメントを与えられます。  
あなたの回答はできるだけ正確であるべきです。  
あなたの回答は製品情報を含む取得されたドキュメントからのみ来るべきです。  
取得されたドキュメントにユーザーのメッセージに完全に答えるための十分な情報が含まれていない場合、質問に答えず、十分な情報がないことをユーザーに通知します。  
   
## 取得されたドキュメント  
製品名: Trailwalker X1  
製品説明: 私たちの専門的に設計されたハイキングシューズで、ハイキング中の持続的な快適さを体感してください。クッション性のあるインソール、サポート力のある足首カラー、通気性のある素材を備えており、トレイルでの一歩一歩が快適に感じられます。水ぶくれや疲労にさよならを告げ、長距離トレッキングを楽しみましょう。  
   
製品名: Sandwalker T7  
製品説明: 多用途性と耐久性を念頭に置いて作られたこれらのハイキングシューズは、軽量設計と通気性のある素材を特徴としており、暖かい砂浜でのハイキングに快適さを提供します。特殊なソールは緩い表面での優れたトラクションを提供し、速乾性のアッパーと砂が入りにくいクロージャーにより、海岸での冒険中も足を保護し、破片を防ぎます。  
   
製品名: Mudmaster P9  
製品説明: 高度な防水素材と多方向のアグレッシブなトレッドパターンを備えたこれらのハイキングシューズは、滑りやすい泥だらけの地形で優れたグリップと安定性を提供します。耐久性のあるアッパーと強化されたトウキャップが擦り傷から保護し、クッション性のあるミッドソールが最も過酷なハイキング中でも快適さを確保します。通気性を考慮して設計されており、湿った過酷な状況でも乾燥して快適な足環境を維持します。泥や険しいトレイルに妥協しない冒険心旺盛なハイカーに最適です。  
   
製品名: Rockclimber U5  
製品説明: ロック愛好家のために設計されたこれらのハイキングシューズは、岩場でのトラクションを強化するための高度なゴム製アウトソール、擦り傷から保護するための強化トウキャップ、安定性を確保するためのぴったりとしたサポート力のあるフィットを特徴としています。岩場の景観を登るのに理想的で、耐久性、快適性、グリップの完璧なブレンドを提供し、自信を持って上へと進むことができます。  
```  
   
会話をクリアして、もう一度質問してみてください。  
   
```text title="ユーザープロンプトに入力:"  
泥だらけの旅行に適したハイキングシューズをおすすめしてくれませんか？  
```  
   
アシスタントはMudmaster P9のシューズを推薦するはずです。  
   
### Retrieval-Augmented Generation  
   
Retrieval-Augmented Generation（RAG）は、言語モデルと検索システムを組み合わせて、より正確で詳細な情報を提供します。必要なステップは次の通りです:  
   
1. **質問をする**: RAGシステムに知りたい質問やプロンプトを提供します。  
2. **関連情報を見つける**: RAGシステムは、Wikipediaのような大規模なテキストデータベースを検索し、質問に関連する有用な情報を含むパッセージを見つけます。  
3. **最良の部分を選ぶ**: システムは検索中に見つけた最も関連性の高い情報を選び、質問に答えるのを助けます。  
4. **回答を生成する**: 選ばれた情報を使用して、言語モデルが詳細を含む応答を作成し、回答をより正確で情報豊かにします。  
5. **応答を提供する**: 検索から得た特定の情報で強化された回答を受け取り、質問に対するより良く、情報に基づいた返答を得ることができます。

![Retrieval-Augmented Generation](./../images/rag.png)

:::info もっと知りたいですか？ワークショップに参加しましょう: 「PromptflowでRAGアプリケーションを構築する in Azure AI Studio」。[Microsoft AIツアースケジュールはこちら](https://envision.microsoft.com/home):::
